<div class="my-8 w-3/4 mx-auto max-w-2xl">
  <h2 class="text-3xl font-bold text-center mb-8 text-gray-800">Address Information</h2>

  <form [formGroup]="addressForm" (ngSubmit)="onSubmit()" class="space-y-6">

    <div formArrayName="addresses">
      <div *ngFor="let address of addressesFormArray.controls; let i = index"
           [formGroupName]="i"
           class="bg-white p-6 rounded-lg shadow-md border border-gray-200 mb-4">

        <div class="flex justify-between items-center mb-4">
          <h3 class="text-lg font-semibold text-gray-700">Address {{i + 1}}</h3>
          <button
            type="button"
            *ngIf="addressesFormArray.length > 1"
            (click)="removeAddress(i)"
            class="text-red-500 hover:text-red-700 font-medium text-sm"
          >
            Remove
          </button>
        </div>

        <div class="space-y-4">
          <div class="relative">
            <input
              type="text"
              formControlName="address"
              class="peer w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors placeholder-transparent"
              [id]="'address-' + i"
              placeholder="Your Address"
            />
            <label
              [for]="'address-' + i"
              class="absolute left-4 -top-2.5 bg-white px-2 text-sm text-gray-600 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-2.5 peer-focus:text-sm peer-focus:text-blue-500"
            >
              Address
            </label>

            <div *ngIf="getAddressControl(i, 'address')?.errors && getAddressControl(i, 'address')?.touched"
                 class="text-red-500 text-sm mt-1">
              <span *ngIf="getAddressControl(i, 'address')?.hasError('required')">
                Address is required
              </span>
            </div>
          </div>

          <div class="relative">
            <input
              type="text"
              formControlName="streetNumber"
              class="peer w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors placeholder-transparent"
              [id]="'streetNumber-' + i"
              placeholder="Street Number"
            />
            <label
              [for]="'streetNumber-' + i"
              class="absolute left-4 -top-2.5 bg-white px-2 text-sm text-gray-600 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-2.5 peer-focus:text-sm peer-focus:text-blue-500"
            >
              Street Number
            </label>

            <div *ngIf="getAddressControl(i, 'streetNumber')?.errors && getAddressControl(i, 'streetNumber')?.touched"
                 class="text-red-500 text-sm mt-1">
              <span *ngIf="getAddressControl(i, 'streetNumber')?.hasError('required')">
                Street Number is required
              </span>
            </div>
          </div>

          <div class="relative">
            <input
              type="text"
              formControlName="markAsLocation"
              class="peer w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors placeholder-transparent"
              [id]="'markAsLocation-' + i"
              placeholder="Highlight this location"
            />
            <label
              [for]="'markAsLocation-' + i"
              class="absolute left-4 -top-2.5 bg-white px-2 text-sm text-gray-600 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-2.5 peer-focus:text-sm peer-focus:text-blue-500"
            >
              Highlight this location
            </label>

             <div *ngIf="getAddressControl(i, 'markAsLocation')?.errors && getAddressControl(i, 'markAsLocation')?.touched"
                 class="text-red-500 text-sm mt-1">
              <span *ngIf="getAddressControl(i, 'markAsLocation')?.hasError('required')">
                Highlight this location is required
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="flex justify-center mb-6">
      <button
        type="button"
        (click)="addNewAddress()"
        [disabled]="!canAddMore()"
        class="bg-green-600 text-white py-2 px-6 rounded-lg font-medium hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center space-x-2"
      >
        <span class="text-xl">+</span>
        <span>Add New Address</span>
        <span class="text-sm">({{addressesFormArray.length}}/{{maxAddresses}})</span>
      </button>
    </div>

    <button
      type="submit"
      class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-medium text-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
    >
      Add Addresses
    </button>
  </form>
</div>
